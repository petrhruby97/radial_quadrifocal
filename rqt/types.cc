#include "types.h"

#include <fstream>
#include <iostream>

namespace rqt {

// clang-format off
std::complex<double> default_problem[224] = {{0.9996507726281429,0.0264259869060017},{0.152500188632604,-0.988303441493057},{0.669159793102535,0.743118544577494},{-0.238566701238996,0.971126113880141},{0.695289366305456,0.718729919443012},{-0.756630371681824,0.6538428562342981},{-0.363201028071939,0.931710799125719},{0.504252476068778,0.863556275165959},{0.624866693583319,-0.780731461675684},{0.884031707925807,0.467426934805624},{-0.997087759201983,-0.07626270680724991},{0.9496723093231,0.313245119522923},{0.950015064504401,0.31220406341798},{-0.89760546344797,-0.440799764052064},{-0.653724046118178,0.756733025265106},{-0.991516457550806,0.129981207895221},{-0.964288955184865,0.264852432325022},{0.977970776796014,-0.208741849500767},{0.429420201422897,0.903104805994254},{-0.875174009495816,-0.483808281350183},{-0.243361608637008,0.969935630566074},{0.876367287546275,-0.481643413033735},{-0.0328656072295419,0.9994597800118989},{-0.79996652036155,-0.600044636923483},{-0.702866071271262,0.71132220958979},{-0.180104252676921,-0.98364752740384},{-0.512384212369855,-0.858756321032994},{0.596112351204665,0.802901030477135},{0.232528603387534,0.972589558141893},{-0.06392357289926789,0.997954796986212},{-0.108335688307086,0.994114368993342},{-0.5852780301856499,0.810832675329507},{0.992551529374647,-0.12182553729021},{0.985588517708419,-0.169160497047395},{-0.9330366071526039,-0.359781447149736},{0.222440993653001,0.9749461545863271},{0.996998132854808,0.0774255970853792},{-0.95694309180276,-0.290275591552191},{-0.516068916606078,-0.856547064272028},{0.986872561333436,-0.161500921629515},{-0.9300532598357431,-0.367424732249897},{-0.98725388681159,0.159153268817853},{-0.957982668475252,-0.286826091736848},{-0.222300377813449,-0.974978226435851},{0.829271978277948,0.558845225481062},{0.195534878081564,0.980696747957098},{0.087027435740039,0.996205915174425},{-0.0566918026279253,-0.99839172648555},{-0.842670072810772,0.538430263255223},{0.921443571785018,-0.388512218618758},{-0.740658309676313,0.671881885681871},{-0.890696119151009,-0.454599189758772},{-0.821526848367616,-0.570169832077401},{-0.962744127299223,0.270414025802762},{-0.317654184465127,-0.9482066331194881},{0.725271938569365,0.688462500884279},{-0.9788626399857689,-0.204518781631641},{0.791391118368762,0.611310148588293},{0.9999347330774641,-0.0114249544988222},{-0.775237333986191,-0.631670068939461},{-0.89947782552096,-0.436966407628876},{-0.587330755785225,0.8093470104403649},{-0.341724843715957,-0.939800048514206},{0.998341894617813,0.0575626741119228},{-0.7048657718074131,-0.709340710613976},{0.874377051227733,-0.485247124964481},{0.539814711876982,-0.841783865871264},{-0.893318735276933,0.449423672277308},{-0.751081890222011,0.660209053391827},{-0.218359897850856,-0.975868308231476},{0.0026685062091381,0.999996439530967},{0.812012498479173,0.583640045159353},{0.216205268986139,-0.976347930638782},{0.774277961307404,-0.632845667310482},{-0.9674587234291639,0.253028888589452},{0.447452670166827,0.894307613721686},{-0.744395843923662,0.667738592226913},{-0.924317604528033,0.381624116061287},{-0.170756514023751,-0.985313256238064},{-0.939396661588612,-0.342832192473478},{0.06748867272757141,-0.99772004041889},{-0.997128054861805,-0.0757340227870788},{-0.646836126893871,0.762629021834952},{0.08575450526976131,0.996316297581214},{-0.6550412116130639,0.755593151827416},{0.416411242169678,0.90917637309529},{-0.729038283688863,0.684472921974271},{-0.117873401211967,-0.993028630648041},{-0.782995737429335,-0.622027069481298},{-0.723940984456569,-0.689861907213359},{-0.787833777512903,0.615887927312875},{0.432329277276289,0.901715806676229},{-0.781489584252497,-0.623918287682657},{-0.685313510977815,-0.7282481662670089},{-0.999756163481743,0.022081974102575},{-0.685974329701202,0.727625741017308},{-0.123515661073814,-0.992342623023671},{0.99511171244466,-0.09875565682763091},{-0.532684844751713,-0.846313686626799},{-0.999985080071259,0.00546256669312194},{0.766965653434735,-0.641688153585081},{-0.9172576093767369,-0.398294461473511},{-0.9246881743904271,-0.380725334253577},{-0.114907667017962,-0.9933761765114409},{-0.0035981982667305,-0.999993526463663},{-0.9745473585244649,0.224181725376952},{0.491285638191005,-0.870998519922541},{0.198634188217521,-0.980073700938438},{-0.119467381550142,-0.992838126154285},{0.0335320916703828,0.999437641290445},{0.498598210778972,0.866833215911808},{-0.728116538104377,-0.685453358689632},{0.724944403821678,-0.688807383357374},{-0.984868077459378,0.173305712547133},{-0.363107684983451,0.931747180895096},{-0.936777346035079,-0.34992599782736},{-0.962127809074705,0.272598750923604},{-0.41715112751691,0.908837134370824},{-0.506920424165928,-0.86199285586566},{-0.9716017196271099,-0.236622269487981},{0.966467949944023,0.25678726940991},{0.253612552948187,-0.967305883879088},{0.527189436327874,0.849747785065838},{0.974577181592885,0.224052041094183},{-0.9971075062332601,0.0760040855039372},{-0.512607538225847,-0.858623032392002},{-0.91413094069999,-0.405419071153481},{-0.109124371116951,0.9940281040435071},{0.445325889937633,0.895368556378465},{0.997684668674056,0.0680095720670261},{-0.396739553476695,-0.917931221120141},{0.516246020254998,-0.856440334507242},{-0.369817822873523,0.92910428794893},{0.343168017467077,0.9392740344477301},{0.318979657112181,0.9477615619704119},{0.637562384659232,-0.770398731610867},{-0.469622732356278,0.882867197971599},{0.9980096517070089,0.0630613597986476},{0.962620613701635,0.270853381143171},{-0.998560974593621,0.053628164416072},{0.373783243970709,-0.927516084241526},{-0.325493430258939,-0.945544301901433},{-0.542451665831208,0.840087013491429},{0.147657931940231,0.98903849021923},{-0.317675940550054,0.948199344439574},{0.934487399793102,0.355996207322393},{0.833210523670078,-0.552955896293216},{-0.996469380184187,0.08395697919376111},{-0.761837696709171,-0.647767955268602},{0.0756210723243929,-0.997136627258526},{0.0462517689241208,0.998929814286965},{0.292441149374079,0.956283521845257},{0.781614400643731,0.623761916684836},{0.485079096381396,0.874470279800182},{0.464440799605166,-0.885604168724444},{0.826506044921092,-0.562927844140698},{0.52745536838823,0.849582741325668},{-0.835713899843929,0.549165073186243},{0.0958966078158326,0.995391300248006},{-0.886000085416809,0.463685074852973},{-0.119923257082312,-0.992783164850598},{0.72276768315488,0.69109107662227},{0.755659769521183,0.654964359890821},{0.0756982325966894,0.997130772557811},{-0.964407652130054,0.264419894321506},{-0.931722262841568,0.363171619107809},{0.927356391103013,0.374179267037066},{0.999737155399839,0.022926406457147},{0.658812554903354,0.752307129769295},{0.982464102207104,-0.186451837948539},{0.687529836863907,0.72615612881934},{0.414548267373492,0.910027325973037},{-0.932297449434206,-0.36169250168959},{0.99834324364984,0.0575392723165416},{-0.0104907580927049,0.999944970483196},{-0.585465911236267,0.810697025269174},{-0.622036173433596,-0.782988504985922},{-0.949952086457478,-0.312395636069207},{0.973444509086908,-0.228923104400908},{0.36727892782685,-0.930110847788778},{0.588362601622182,0.808597210613775},{0.707237775821416,0.706975762279851},{0.990493443544577,0.137559944370468},{0.6127286727579691,-0.790293346536751},{-0.529437027344891,0.848349240629238},{0.999643235381183,0.0267095854824003},{0.219344656782983,0.97564743711074},{0.369183649287188,0.929356461805154},{0.176676087264771,0.984269048679685},{-0.0949277804982151,0.995484161847733},{-0.729176891090912,0.684325260018211},{-0.249579676982734,0.968354266184228},{-0.1667898917772,-0.985992460417903},{-0.221060557191905,0.975260083287532},{-0.7594293333104,-0.650589799879863},{-0.629177822845539,0.777261389263192},{0.414801284678791,0.909912025543582},{0.666949594544894,-0.745102837423399},{-0.488168777883403,0.87274924480049},{-0.968582372500962,-0.248692958646618},{-0.10285883397917,-0.994695963735877},{-0.994472217676051,0.105000039383218},{-0.927322416229806,-0.374263458485749},{0.403903120498419,0.914801765002473},{-0.522183668770366,0.852833052871147},{0.844132301099514,-0.53613492540632},{0.708194787946718,-0.706017097756919},{0.995502346434577,-0.0947368895586698},{0.9593569418204561,-0.282195425513779},{-0.916752163419055,-0.399456469301076},{0.999268928131736,-0.0382309988157623},{-0.316712161327744,-0.94852169551735},{-0.503709624395588,-0.863873031348505},{0.876576223438181,0.481263051254568},{-0.5634373813106059,0.826158772477692},{-0.903277229093531,0.429057394064142},{-0.827233217235371,0.561858704927152},{0.540938551880049,-0.841062116071052},{-0.108581649680134,-0.994087534049563},{-0.570259278487925,0.821464762055215},{0.709558997567438,0.704646030976612},{-0.738175553044765,-0.674608666477873},{-0.7935430721171221,-0.608514085864017},{-0.569402351553723,0.822058977230399}};
std::complex<double> default_sols[28][13] = {
{{-3.64383920676239,-0.983510584318127},{-8.45284713490171,-4.71556467696826},{-7.49416695469569,-4.31779800833229},{-8.28678081672205,-2.47827561778446},{-6.90402871411612,-2.07900833084051},{-3.29880937225167,4.09688405098723},{-3.84809257526009,3.26225968591902},{-2.94459347527261,3.93875405703051},{-4.32447793649154,2.32029337132986},{-2.85595056908517,0.281909682186216},{-3.18866173389288,0.406425571233922},{-2.6077701344458,1.11951561666007},{-3.20533111852906,0.418806554259014}}, // Solution 0
{{-1.49632191038818,0.503000121877764},{3.90116037231955,-6.8981874261585},{1.94545656394038,-7.69983451558564},{2.94656387300314,-6.1434536334667},{-0.182568510118876,-7.48929289902909},{-4.19109984138504,-5.71871510881448},{-4.71343203789528,-5.77998761188618},{-3.04355356177754,-5.84932805797758},{-5.59961405969019,-4.97028616281534},{-5.96792584178781,0.964635993391096},{-5.89424488111247,-0.0219107909642299},{-4.0522554806953,-1.74239329821325},{-4.93556104110264,0.731460509471791}}, // Solution 1
{{-0.771059542470944,0.481554474819043},{-1.87011182525836,-1.0360073081573},{-1.70057498894849,-1.29384431771047},{-0.770581955114348,0.590099629241528},{-0.611667658995413,-1.1512148156008},{-1.0763141939077,0.145646638009788},{-0.7841529741954461,-1.53992488272241},{-0.795626589288131,-0.34368700464019},{-0.112576989475899,-0.943837514350404},{-1.81306919743159,0.366265669448644},{-2.40596679104192,1.38464618649185},{-2.39927688800568,0.83255617201704},{-2.15076598962524,0.513642930205062}}, // Solution 2
{{-0.624551688262638,-0.220019859030463},{-4.06489682246936,-1.39693866164822},{-2.72721473923025,-0.977415794800133},{-2.81403633494047,1.18537878182362},{-3.99937741352144,2.15196952946915},{-0.632053213411394,1.20334379074082},{-1.83677485543733,0.321401920811152},{-1.20344845464332,1.19002349448529},{-2.74844674259823,-2.06136427539157},{-0.647245805624024,-0.6236158784131191},{-0.642441304238243,0.0221446508045708},{-0.398751163049315,0.369826360494303},{-1.50870989289935,0.238899824665178}}, // Solution 3
{{-0.373444643609723,-1.2614036952075},{0.454660083173395,-1.22325472236787},{0.517064540434048,-1.2390078828189},{0.289522231586018,0.09986906401891291},{0.118182986342196,-1.01608473904015},{-0.803302954984361,-0.640780631625797},{-1.76084505694012,-0.864634743370487},{-0.200853257328358,-0.280730894501042},{-0.684386185134082,-0.312484418279165},{-2.1122537748047,-1.43458625776056},{-1.60777929037382,-3.87383916563151},{-0.0325490837742798,-1.91740376229014},{-1.68534518588855,-1.12719708762288}}, // Solution 4
{{-0.365360872516761,-1.5319417150554},{0.263123464613441,-1.48275873473032},{0.483327879937638,-1.48982788382541},{0.169381392612608,-0.104416333062725},{0.0142959291920508,-1.25349188809838},{-1.02480740232882,-0.417317105221535},{-1.81011123509266,-0.80452951333282},{-0.415128628449553,-0.115663629205034},{-0.772349827754973,-0.235272404703124},{-1.97899087068451,-1.53809102023024},{-0.880401609863371,-3.49876733040233},{-0.55112841033203,-1.61425457316806},{-1.63471815481072,-1.2588297477644}}, // Solution 5
{{-0.337786255870733,0.196655057137999},{-0.712265021558237,2.29450976027212},{0.133027078648236,-0.133373991533023},{-2.76430984642753,2.02955071749785},{1.13485097248115,3.92186131405468},{1.01273402415094,-0.501174273377508},{-0.21632064560315,0.172725409340892},{0.446311555733248,-0.880313737598869},{-1.66524889161967,-1.01442538139526},{-1.07359714880495,-1.66991099773234},{0.21146224450917,0.673586351402319},{0.251166776415593,-1.5398496691693},{-1.84269569677079,-0.205692012087867}}, // Solution 6
{{-0.254530930131233,-0.434694958714815},{-0.439330107901869,1.8804453661659},{-0.6057039046810631,0.464675849832974},{-3.22496280091633,2.13489832672351},{0.0633699672534893,1.79255444830254},{0.320022533141351,-0.817532036295894},{-0.0297202242383334,0.265517416190012},{0.433440774673471,0.511561385117018},{-0.138468831095598,-0.0754783763921292},{-2.24832957652521,-2.13396222884141},{-0.431429639622962,1.12140722824961},{2.03185479503492,1.29112512196026},{-1.26424438486255,-0.578367840823399}}, // Solution 7
{{-0.0616512634894509,-0.132282301580854},{-0.9529173663960649,-0.158563504628798},{-1.05726669083443,-0.487477853586787},{-2.95278874732491,2.13211240565541},{-0.241060488437432,-0.411402122201177},{1.10542879586351,-3.5342926898453},{-0.334580539818374,0.0187478757016443},{-0.621884559572833,0.109415196493974},{-1.60013653029832,-0.986589954472018},{-2.83843406520661,-3.72535882558242},{0.0261824141968037,-0.130174876074422},{-0.663252497691207,-0.40051952231147},{-1.36495402811696,0.0098823670340579}}, // Solution 8
{{0.0739127061598963,2.7925576648422},{-1.81392496229557,-0.0393012886045333},{-1.20425562823716,-0.607476674926541},{-1.6183614364485,-1.1192493953026},{-2.14011949188257,-0.532733842803026},{-1.50859594822495,-2.49368717856061},{-0.86187015877597,-0.8308258396806329},{-0.775188340183785,-2.60314335886634},{-1.25071988314532,-3.42532654484094},{-2.36823910014046,2.05093812686129},{-2.36180231078638,-0.448843563617627},{-2.33402178676524,0.749543406785622},{-2.31261858029189,2.21621342413645}}, // Solution 9
{{0.118443061560214,1.79257108983007},{-1.81369840264923,-0.285414655619525},{-1.27324733625237,-0.937911489057473},{-1.10073511925772,-1.56276111213533},{-0.894179123640669,-0.872857569277807},{-1.92972670798647,-1.55328664026494},{-1.08314012856596,-0.352695123372575},{-1.1285261426625,-1.76283012317117},{-0.456527361895617,-1.62872790057906},{-2.03634795146208,1.51347734286588},{-3.54774105133643,1.54562720755274},{-3.01924814193752,1.35900580883098},{-1.98618077138309,1.5989392279883}}, // Solution 10
{{0.129312839448665,1.97311385555807},{-2.29545623207955,1.95887514646179},{-1.35421004705033,1.96217058611115},{-10.7748962375814,1.53421643918103},{-3.13040410749314,1.57596583432294},{0.274214706791861,-0.193068123081043},{-0.0172164901846686,-0.120525206699259},{0.908842527172751,-0.559807517319001},{0.220035324377204,-0.119963727942044},{-1.03630257651967,1.2053057372999},{0.511314612744715,0.954419151750259},{-9.579035256780919,8.641510129006299},{-1.34457949566752,1.15419527132291}}, // Solution 11
{{0.149189506496228,0.43546129277836},{-2.25884354442658,0.270677494512827},{-0.502627607105147,0.477006709746399},{-0.107964648962386,-0.349568087999367},{0.98809373799968,-0.183377362805851},{-0.84260303580796,0.912009251661571},{1.6202919328731,1.53639027780414},{0.146232455364111,-0.394556846260977},{2.5901783182657,-1.53056977385448},{-0.295700099346603,0.964801417215264},{-1.32508839406217,-0.255180261018964},{-0.435512740029271,0.383554235091521},{-1.30439235662127,0.163706092249565}}, // Solution 12
{{0.260635559933213,-0.595875560842335},{-0.135095091769673,0.841096633050038},{-0.480056184520604,0.473932632150293},{-1.36122733318332,1.29700573529017},{0.262899204492021,0.769745305267283},{-1.1946116306054,-0.436582361861835},{-0.309738513571563,0.5836150403320139},{0.00438201903592425,0.555364075999192},{-0.131279554125458,-0.291310923608079},{-2.18067221571013,-0.858642582096168},{-1.90184462808497,1.62048918851},{-1.70030519185122,1.31975844052057},{-0.860619639511073,-0.541045382618776}}, // Solution 13
{{0.425703451515283,-0.112177388901078},{-0.896662194076904,-1.22987591328605},{0.0468796483649405,-0.242048388128206},{-0.355926798507271,-0.354347785797161},{0.120956908149826,-0.5495704045676409},{-2.24811399987057,-0.893833127172699},{1.25095138086526,1.22717739819283},{-0.403807048167386,-0.609955844237786},{0.854836709192038,-2.42240902022877},{-1.90843442047935,0.699766960594291},{-1.50923894671951,-1.74776152228141},{-0.755836980367648,0.240337784532877},{-1.19215698945287,-0.111342577191475}}, // Solution 14
{{0.456372043576157,-2.74782940309563},{1.4756721113763,-0.31541350789002},{1.70750491090228,-0.459967817947128},{0.27356293138894,-0.202729765110513},{1.23827046786124,-0.425852904362613},{-0.72727099317831,0.383685969910257},{-1.48506369831281,0.747644714274414},{0.0501103780059653,0.585642595614784},{-0.656652515449007,0.327144198514144},{-0.992586680859288,-2.48984660599999},{-1.96458001023353,-5.07025064976613},{-2.53335608463782,-0.229710528912297},{-0.619878764030798,-2.33692184169066}}, // Solution 15
{{0.5117893525324539,-1.06965019596308},{0.890343999196253,0.314576847402878},{0.765186209049278,0.384350817354681},{0.147214504511168,0.864730023515058},{2.32867376922178,0.341640342884125},{-0.778781554941393,-0.357219949692061},{-0.736930320715351,-0.0537023868438063},{0.247821367695662,0.0588583922879445},{-0.194391195261752,-0.0237334622722329},{-1.53054449637275,-1.07709038894305},{-1.12049898922597,-0.463686634348755},{0.281321835375945,-0.432773047674352},{-0.788313243720002,-1.06535603509359}}, // Solution 16
{{0.54059685692973,-0.705906115517586},{3.35102554736126,-0.69617082678603},{2.65912668768453,0.760042060904381},{2.77849597953835,0.781968194263753},{6.50867798473569,0.0589735274439383},{0.0340085888117187,-1.54475336299852},{1.19822621972878,-1.57480217747668},{1.36473127541196,-1.47096564931733},{4.36283687196847,-1.14752330148899},{-1.94493204090002,-0.492639984319231},{-0.713299553427419,-0.314927751126031},{-0.956166063153284,-0.334662047132253},{-1.19954685591269,-1.31665863267397}}, // Solution 17
{{0.552256954622954,-0.844680324335047},{-1.1197675853935,0.0805334857158425},{-0.714916120771357,-0.235545549784316},{-1.25036986322154,0.0827191122542328},{0.912430015171624,0.582860625110775},{-1.87844328968543,-0.00596178088091446},{-0.636757756679602,0.964559507905914},{-0.895915106218708,0.62353842507283},{-0.91081024655341,-0.324644280876927},{-1.41491705543386,-0.719499488863095},{-1.35348017908635,-0.501187102368198},{-1.7325159530188,-0.802421862474715},{-0.68074311460491,-0.413857606269073}}, // Solution 18
{{0.709262849646296,-1.01774170209195},{0.440228211861253,-0.171997049221546},{0.629592882470015,-0.0226712906225928},{0.436888657588582,-0.127422283185291},{0.317150453403535,-0.135023443644514},{-1.28661262395937,-0.439910853482374},{-0.193912948920168,-2.14837177821137},{-0.289047305212203,-0.0862364568409706},{-0.762629194013174,-0.000779477621301612},{-1.31955211088204,-0.837669662119341},{-4.00003037995846,-5.02419318672395},{-0.22021834861584,-1.44302463779261},{-0.732971083975146,-0.841731329518479}}, // Solution 19
{{1.38231157408496,-0.380922402589417},{0.791525647930836,1.84182111929329},{0.727314039255045,2.33687565070894},{0.834003865592071,-0.503075498838285},{5.38640616049966,1.0787263295981},{-0.418551681068447,0.332470520308679},{-0.935666614926459,0.681372701139156},{0.837899534456062,0.284666216293603},{1.33394101569661,1.4253575676713},{-0.44758379951262,-0.138403633050634},{-0.218089272295382,-0.00809970672217636},{0.212963360193788,-0.42456227232475},{0.0565388814576589,-0.652760149256723}}, // Solution 20
{{1.49806347045251,0.161575431972568},{-1.72169297758532,-0.935930255937227},{-0.691188342420909,-1.59342872249451},{-1.26632967069807,-0.575600365295256},{-1.11736936448081,-0.639601138374542},{-3.69193911734967,-1.20234510663845},{-1.47095586625408,-2.18218312432773},{-2.70536811913818,-0.999286478655918},{-1.32390623632198,-0.86350691793823},{-0.972975980990143,0.704454939144132},{-2.71497208748222,1.81883782590866},{-1.6971275572985,0.176359989415422},{-0.686442508313886,0.9207312998693949}}, // Solution 21
{{1.68908220573791,-0.443409737565857},{-0.09583698864414179,0.506429163670353},{0.429711400935998,0.5427092519458649},{-0.141322551024714,0.280720687249279},{0.150002792584634,1.28246389395986},{-1.8932225718354,-0.355898630663602},{-4.63494532574252,3.77366219696034},{-0.873701411478666,-0.270660202027503},{-1.36887982128475,-5.95113711158634},{-0.386705231242691,-0.0410570000184117},{-0.507608935214194,0.114764319377263},{-0.268369366046896,-0.00682633060104485},{-0.0614808084310254,-0.148352629425171}}, // Solution 22
{{1.95389624586558,-1.00714308041366},{0.567871932422044,1.45485399582146},{0.8139002078879159,1.47091283545589},{0.204144938487661,0.756946362993828},{0.499856387966171,0.977172571597018},{-1.31430814661348,0.294722482297079},{-2.1086979681429,1.1943336079518},{-0.308951335007562,0.395336947715039},{-1.08277749373683,1.31587745471661},{0.0579897822699884,-0.637004422862237},{-0.7671240334491241,-0.570722632075939},{0.155903095951831,-0.952050158684313},{0.469406171010873,-0.739488769638275}}, // Solution 23
{{2.0746416785549,-0.776367369787297},{1.12271093462085,-1.30293094423664},{2.10478894559533,-1.13295486799204},{1.17036663588149,-0.75386836893359},{0.472073459204858,-0.945735662903778},{-2.47403244214255,-1.98939999319966},{-2.26550929351954,-4.2232871749827},{-1.69150389152159,-1.93312289716433},{-1.37085541456986,-1.23316171776303},{-0.439636457924336,-0.327782458685487},{-0.0736554100363357,0.855419069883798},{-0.865414270331561,-1.49447026150722},{-0.404521911817235,-0.297945705584096}}, // Solution 24
{{2.28564133962086,-0.407281050101759},{0.10461858299023,1.37702003837126},{0.531745877160493,1.37770564484591},{-0.154214634824394,0.787246610221224},{1.00960170415224,-0.350103284505968},{-1.76801894691222,-0.0559123122691901},{-2.90534243740557,1.49148308148524},{-0.790391537590315,-0.0248767736502415},{0.425786973647059,7.74342782510507},{0.231700138322914,-0.000566020681782157},{0.12688290550604,-0.038342916975882},{0.194289907495532,-0.033686670243333},{0.528891786750168,-0.104818387894248}}, // Solution 25
{{3.57353440597179,-0.6858265954591199},{1.69118739535014,3.14822658385429},{2.03474623248326,3.25927917638036},{0.105886608650552,1.28868636440591},{1.20767853846472,3.2789496015208},{-0.890416777820465,0.00143911775841452},{-1.28491764629386,0.407118585408323},{0.0124373070604124,-0.0407623020936239},{-1.04052906942111,0.06787697215273129},{1.46118957385113,-0.453516061279386},{1.52941891927532,-0.84523101993764},{-1.26319570987371,-0.6786734127747019},{1.68546570107942,-0.584446786785785}}, // Solution 26
{{4.57733174561259,-3.44250809877689},{7.88798587368149,1.85815053023804},{8.26160236564739,2.17443854396386},{6.57986662527474,4.45997451590006},{8.33038551283348,1.59578922818147},{0.201201395748042,-2.34828590988669},{-0.08004825343581159,-2.78587242906633},{0.994572959534044,-2.43615379140111},{0.666295078442483,-3.13466501850566},{1.7435373966285,-3.30411055772057},{2.1658639017898,-3.10479398195113},{2.42456544346468,-2.5763559260077},{1.85516872079172,-3.44343497000043}} // Solution 27
};
std::complex<double> upright_problem[114] = {{.826446107214556, -.563015836251438}, {-.9950759748169, .0991151065287072}, {.799061287310111, .601249581390547}, {.74197798427883, -.67042424691051}, {-.449932722148672, .89306245332557}, {-.285556394605514, -.958361907371062}, {-.700985441337406, .713175582190671}, {.20115096511194, -.979560252988317}, {-.50190182300693, .86492459790569}, {.571931845045826, .82030114264365}, {.838111112153578, .545499554247932}, {-.388051010107849, .921637897199479}, {.217895868493245, -.975972023417462}, {.924814428484062, -.380418549584137}, {.136468501221827, -.990644410560252}, {-.825781732271046, -.563989832042591}, {-.841124241611375, .540841945649271}, {-.629174328314836, .777264218004132}, {.0844759805725797, .996425515884806}, {-.528740489548785, -.848783538195523}, {.978113102253717, .208073927246087}, {.993929186109748, .110021693311884}, {.601687204282867, -.798731812439111}, {.266076984321198, -.963951782204139}, {-.297937734098958, -.954585306088449}, {-.862603474642896, -.50588066333277}, {.387012542285177, .922074450418167}, {-.939045604021609, -.343792602549403}, {-.975753600102905, -.218871907485223}, {.364486640287911, -.93120861736328}, {.987082481702006, .160212903091511}, {-.536145081151832, .844125850780969}, {.881164751276661, .472809349640572}, {.967651082946719, .252292254482856}, {-.839734750287748, -.542996822420881}, {.363204251805556, .931709542438182}, {-.743395909006062, .668851644591722}, {.999278515932448, -.0379795681366186}, {.568606866317394, .822609404016702}, {-.152010758783015, -.98837883891462}, {-.150722994031381, -.988576036059046}, {.501720464856727, .865029811708215}, {.0552642918217015, -.998471761267912}, {.920265038324468, -.391295616174862}, {-.999061583845973, .0433122578859125}, {.654573092615738, .755998721178461}, {.959855944755807, .280493431860601}, {.971166029507712, -.238404159213354}, {-.967563506767525, .252627908932743}, {-.995071177236558, -.0991632605003026}, {.920213122470744, .391417691517187}, {-.311442340108371, -.950265051860702}, {-.985937454760234, .167114736935169}, {.714898752690672, .699227983851705}, {-.670252142629757, .742133455181897}, {.777640665615941, .628708990853794}, {.281583756450601, .959536652819041}, {.162008253951405, -.986789402887778}, {-.744932681562249, -.667139640510499}, {-.632253379142409, .774761682430801}, {.995804118608438, .091510422152195}, {-.120141146564987, .992756820627313}, {-.895873420277859, -.444309368390597}, {-.0417359796100377, .999128674398844}, {-.774304834705258, .632812786653417}, {.48694759280905, -.873431188965377}, {.840620325046268, -.541624841674666}, {-.999988189937148, .00486003973499997}, {.710969753614548, -.703222588833201}, {-.172760855099184, .984963799814693}, {-.87102049795189, -.491246671385813}, {.706783365089797, -.707430049427039}, {-.605539624115109, .795815156695657}, {.749273812162098, .662260337335762}, {.997664070291067, -.0683110741407394}, {-.858312853133453, -.513126734974812}, {-.727032100988603, -.686603469356293}, {.291376872596323, .956608341023632}, {.193634999215333, .981073639987783}, {.725904463766451, .687795543373132}, {-.999588898087049, -.0286711496302269}, {.761588791931792, -.648060577418403}, {.0710820286335475, -.997470473350134}, {-.555239587213056, .831690447697625}, {.247634435715528, .968853542207413}, {.992216524811444, .124524567419856}, {.721903673432423, -.691993559424344}, {.384015035913521, -.92332683931116}, {.142042594864243, -.989860546362078}, {.450876527594068, -.892586330202696}, {.351030805748564, .936363910782295}, {-.577751424276352, .816212773574787}, {-.997865081163622, .0653091095814277}, {-.360177762401101, -.932883690216383}, {-.609860943666693, -.792508441210547}, {.598333065474105, -.801247491578202}, {.684096881301403, -.729391155001001}, {.986034194562471, .166542988905382}, {.997584944523143, -.0694570259999483}, {.404065914439091, .91472987093923}, {-.999155561584487, -.0410872699846232}, {-.991634863273315, .129074776547991}, {.326051072650502, -.945352155560803}, {-.184201016980198, .982888592539084}, {-.936026103049703, -.351930581804973}, {-.97364169638938, .228082982819872}, {.918487658097098, .395449645243624}, {-.658284240267036, -.752769459407095}, {.820919107599773, -.571044498071378}, {.949513651327069, .31372571769547}, {-.787148201152943, .616763900874302}, {.0700876161318006, .997540839296799}, {.739378570432476, -.673289929811242}, {-.872002572137823, .489501291300667}};
std::complex<double> upright_sols[25][8] = {
{{-3.26935537016759, -2.77410594142043}, {-.211509139724494, 1.69867475520122}, {1.33398404268842, -3.14157694301572}, {.00237616762699096, -.0103530786483338}, {-.00776472960961288, .00502079868183477}, {-.000192306364378564, .00229532850343028}, {.00850333999486916, .0133350140695375}, {-.0276897500143991, .014883673836898}}, //Solution 0
{{-1.80843419889535, -1.61636933101087}, {1.35146639058143, -.277072648242885}, {-.0224615505887948, -1.78732714236264}, {.0838956251430548, -.0421596125101819}, {-.18386529296878, .275027802279061}, {.157211618586795, -.370455950697752}, {.01582473088764, .167760748991919}, {-.290700870233714, -.417587385526101}}, //Solution 1
{{-1.09890221116774, -.714013085275773}, {-2.01271797069391, .721713987731314}, {-1.03181082426262, 1.44259481424495}, {-.0431677247888306, -.120671369440362}, {-.0047457275512145, .0489648396848122}, {-.0539928589756801, -.0537818246945148}, {.0439020008915391, .00836112890429139}, {-.0107130678739562, .0079194148887456}}, //Solution 2
{{-.978042970365936, -.724685688185647}, {.546548351069668, -1.66811542707571}, {2.18243336009609, 1.21836435017698}, {-.0158751003073027, .0580479782626183}, {.0316770978806954, -.0735190421268123}, {.0271113529001457, .293435359348681}, {-.0249560136887189, -.206480666828143}, {.0675888323337046, .0124427924170415}}, //Solution 3
{{-.841203667099948, .715874485556086}, {.00769944744400161, 1.25861425579718}, {3.75822248710587, -.991727625597531}, {-.00432836978819691, -.0279847457434569}, {-.00660317902607375, .0170851882381675}, {.0372416411247517, .162585604181719}, {-.137756244405007, .140117686535862}, {.0155351427695476, .00941937757808963}}, //Solution 4
{{-.704407548662007, -1.2686476620248}, {.318666120910189, -.807533757026468}, {.236262785065503, -.382708866804733}, {-.297978839714212, .222090004046345}, {-.356688611425893, -.421956939003625}, {-.426491657500273, .918660001367961}, {-.241444679044144, -2.17687853773788}, {2.77706024767763, 1.06462771042513}}, //Solution 5
{{-.490712043944288, -.50961055282133}, {1.83407228339183, 1.47138266266801}, {1.39752930597481, -.227949194783501}, {-.222608007287988, .0840377981671865}, {-.0962183742039661, -.155663939311701}, {-.104484815917826, .086611719202916}, {-.0521419490597272, .0134659342018486}, {-.0090574291247892, -.0122191379934748}}, //Solution 6
{{-.371113060225424, -.279637591041872}, {.282302358388015, -.497538906779366}, {.40588710219178, -3.34761261752773}, {.0802384647807532, -.0652718124779946}, {-.124466740047333, -.0248931329471732}, {-.237116241293269, -.0621527084956155}, {.154614115682328, .374644491240375}, {-.0278474982193231, -.149560772028655}}, //Solution 7
{{-.209437606066246, -3.46028733547432}, {1.56206938319117, .258455614564747}, {.897656929688599, -1.22493218869301}, {-.0642370559469298, -.00968388084135762}, {-.0682362731537585, -.0196565306775201}, {-.00850867850979251, .0736427197939948}, {-.0288194310151363, .000365384753986153}, {.114430592103811, .0490213870128822}}, //Solution 8
{{-.190363165763103, 1.04773384803876}, {.0570356229287583, .355844765972341}, {-.0562322230402182, .750079554377819}, {.245362393183486, -1.01762631395539}, {-2.30934762590345, -.316227859000961}, {-.109902910912202, .0552824704854674}, {-.883973670476233, -.282090520830683}, {.662382098043694, .773585539036202}}, //Solution 9
{{-.140437090898407, -2.37378968424537}, {2.25216414810707, -1.1460762223876}, {-.319336392483022, 3.11416442959888}, {.0014016079506148, -.0237899413242392}, {-.0251484542947739, .0217848858009192}, {-.00939182555956514, -.0559997562399197}, {.0158600064916436, .0522971074220692}, {-.0339520554940652, -.0234534986091966}}, //Solution 10
{{-.126687267287778, -.894000142444789}, {.097347028061156, -1.10566932009102}, {.0737954271783608, -.843906181979067}, {-1.20926276731363, 1.24827594045526}, {-5.7289318838426, 22.3296118972332}, {-1.58373616383336, 6.84092694704648}, {-21.2719192825895, -23.2896550807026}, {13.7541637082822, -22.758197853839}}, //Solution 11
{{-.0194058912912569, -1.02951692607532}, {.0263774637822574, .58883898797142}, {-.361844155893283, .657385881069923}, {-.429153752709403, .381804659270197}, {.0546992627679779, .0719057954325699}, {-.492352636841377, .276359461806412}, {.0640928315835095, .0843575719203786}, {.271286386571426, -.177394927719151}}, //Solution 12
{{.0867706409526338, .98481833867823}, {-1.87740880025559, -.558776161634425}, {.814452341891077, -.817608936542438}, {.288157318831286, -.0975947093883624}, {-.40979667607931, .0184635979920928}, {-.121688463297401, -.116875991021113}, {.0875546989391917, .101971186294603}, {-.30263896748973, .097694753994493}}, //Solution 13
{{.135668453850009, -.94687544267073}, {1.4490167194094, -2.01952972608013}, {-.208984109204179, -1.16307723653067}, {.804222520244984, -.420219415390324}, {.223748086818601, 1.78026008544575}, {.0328400609362731, -.076511954240091}, {.0495955416093083, -.107870722383738}, {-.0559460768489451, .0119618776385022}}, //Solution 14
{{.152797814625593, -.93784491422729}, {-.20826420030278, -.814597494249785}, {-1.57112139321495, 1.57075976753406}, {-.103539434508823, .0140100148976956}, {.0309706943860139, .0328742734368664}, {-1.1343527173997, .958463701939113}, {.9909324752479, -.696449741467944}, {-.00777601865402677, -.0295502566816035}}, //Solution 15
{{.200321632841356, .785371364887388}, {-2.19760483592472, -.125106514114895}, {-.579939380335581, .868367972739817}, {.529657217324713, -.0250665919582436}, {.140475068549872, .624104915982169}, {.13901884402675, .0135953049938691}, {.0619163182931433, .00986425318170467}, {-.0220137823415744, .0125161301988597}}, //Solution 16
{{.214094072584311, -1.03575030839549}, {-.339100562128738, -1.08360082047313}, {.0301105848322672, -.953922953397576}, {-2.43322544612947, 3.66008765227352}, {-3.85569423632986, 24.896568463049}, {-1.21941309015578, -2.80720360853125}, {6.31204307647296, .811052597430033}, {-2.69482093687342, -15.1037068022838}}, //Solution 17
{{.39506135116958, -1.50148483016155}, {.0674843212648294, -.660964696811165}, {-.541710463980706, -1.58725136155213}, {.121443582345019, -.0922205349496695}, {.134854518888963, .251091010005485}, {-.167802770359335, -.978295585463982}, {-.707227889592378, .866328991869787}, {-.578345211815042, -.944154284641343}}, //Solution 18
{{.644032750649751, .293198424954524}, {1.03242299359162, -2.53879030250905}, {12.3327966938614, 2.20053461075857}, {.00381302175216742, -.00234321596965082}, {-.0014072856194576, .000574762339881423}, {-.042182039853148, .0233523904313378}, {-.0298948574438133, -.0260553162990819}, {-.000536508992047315, .000503029475843264}}, //Solution 19
{{.722543345199674, .634411983140637}, {-1.00145382105178, .0983140441318947}, {.253917959643779, .325187782825471}, {.420953935858372, -.329402154903842}, {-.310226664034996, -1.88559007847624}, {.349350903471014, -1.00939916287961}, {.339716388848685, .0982413111359998}, {.0876546644169582, -.0666307555788303}}, //Solution 20
{{.856393588077195, .352622738782171}, {-1.24371088037688, .272461462768127}, {-.374565241079917, 1.92733478252846}, {-.142843696397969, .114243321334011}, {.118846668329242, -.0108420915260112}, {-.184791344144611, .0938152610300398}, {.21024296811796, -.0962569966389208}, {.0685884305931067, .0703961869463874}}, //Solution 21
{{1.09666211961938, -.769342271430602}, {-1.4206583851889, -.183146753382357}, {.278698436282572, -1.16221922580489}, {-.501750922569824, .173532265921515}, {-1.16856761731205, -.308766201557724}, {.626340357863294, .337380743424991}, {-.777095029429177, .251455054505596}, {-.0325800239424189, 1.11267211508108}}, //Solution 22
{{1.32430800724193, .709464669767468}, {-.960278726262311, .472432010050552}, {.146988474440477, -.0230984912969946}, {.315140357796827, -.0831715672974278}, {-.198698082088356, -.077373988285841}, {.0873552376985403, -.439397700367656}, {.0524888483500542, .467582113978471}, {-.515847614109216, .418407375021293}}, //Solution 23
{{2.6945714934717, 5.8053850497673}, {.272890439232603, 1.36548526455096}, {.508342340821733, .473470912040039}, {.0153504153304996, -.0667389462432042}, {-.00424532086042944, .0128206156458173}, {-.0136424641115744, -.0304895391410856}, {-.00719866990377597, .00908086140195258}, {-.325350211762939, -.266382037956133}} //Solution 24
};
std::complex<double> nanson_problem[48] = {{.894484382338535, .447099194533438}, {.763828573197754, -.645419174464691}, {-.219492202282531, .975614254271208}, {-.995881457962194, -.0906648867373387}, {.476366616167942, .879246749781143}, {-.224671695343494, -.974434517713469}, {-.738741089559768, .673989319348642}, {-.651108455503205, -.758984702857858}, {.84749660542792, -.530800813665684}, {-.0949340348186771, -.995483565425892}, {-.0687746341550993, -.997632221661286}, {-.0659504152928705, -.997822901482371}, {-.95670331970209, .291064869180395}, {.87248474228512, .488641355678853}, {-.107800235441236, .994172575179387}, {.974406723742662, .224792207883397}, {-.198808507220074, .980038355094802}, {.83808591202756, -.545538270024141}, {.883769834076564, .467921874222912}, {-.626357556617793, .779535894791117}, {.465905609458588, -.884834426926881}, {-.980564400557605, .196197493253874}, {.731079693922609, .682292079049745}, {-.275523991056025, .961294195526302}, {.977592898142406, .210504454825859}, {-.561506382428534, .827472405879508}, {-.0685706236205304, -.99764626475334}, {-.257063534602718, .966394504939653}, {-.0597453925775833, -.998213648507047}, {-.354097938385422, .935208345787822}, {.554490834310852, .83218983090714}, {.984438898994364, -.1757272151568}, {.959946698960236, -.28018268175486}, {.437784827929874, -.899079776457246}, {.460732869455877, .887538857179196}, {.717243895007384, -.696822211955558}, {-.794958531715742, -.606663772490455}, {.809089165499373, -.587685904434953}, {.982707394784293, .185165267359373}, {-.11699627183915, -.993132353906437}, {.971754712694701, .235993174383581}, {-.708810872814717, .705398572850583}, {.855455342403574, -.517876584866688}, {-.203195707811654, -.979138143638027}, {-.268120710630208, .963385325054909}, {-.998004492202151, .0631429611621655}, {.973371252021378, .229234390391875}, {.913651673595122, .406497994259299}};
std::complex<double> nanson_sols[28][2] = {
{{1.86452378171456, -.434876621329796}, {.795917911848264, -2.1483958926088}},
{{-2.05430548238687, -2.13638562191633}, {-3.58687483926792, 3.48514504141723}},
{{-.186584843353921, -.198812319778574}, {-.0742491180552939, .0631471827389442}},
{{.699720704883399, -.131512363636826}, {-1.72140336551436, -.608726147849069}},
{{1.29609567780922, .181788516725324}, {.224694621641655, .130670079912562}},
{{-.838361313812856, 1.10914800585468}, {.343525747506048, -1.1097387822705}},
{{.579311043457119, 2.160791297155}, {-.0947653688844824, -1.32159262243182}},
{{-.20806707627769, .0672641636349209}, {-1.80485965054136, .413488984778223}},
{{-.634824891297976, -.689525360622626}, {-.786131052023588, -.699408032929745}},
{{.0561900254756265, -1.27388004670037}, {.113950628915157, .512687653419274}},
{{.874564869709835, .290120015571954}, {.602098481076533, -.60094968173006}},
{{-.0386198290369442, .0885547032001273}, {-.276179657708943, -.623089338650809}},
{{-.482694954897632, -.801628998538973}, {.446150976671161, 1.53930099831088}},
{{-1.82630846577103, 4.06329236993085}, {2.41908649228486, 1.3870094221097}},
{{-.429741840437471, 2.4071096551855}, {1.15573234132122, -1.18611396290258}},
{{2.2270791083888, 2.64464713327361}, {.273218512249809, -.44098158035533}},
{{-.103688214061295, -.296905487125827}, {-.545063791727369, -.139732700547002}},
{{-.275832958164239, -.0597834254301488}, {-.634406853775112, -.524102685355447}},
{{-2.60219348348407, -.151793509036581}, {-1.21911767356891, 3.35166539262882}},
{{-.482996600175284, -.819774696703889}, {.0415753100237348, -.151118525232654}},
{{-.526384794734538, -.848951983717346}, {-1.03281892096289, .929059737357109}},
{{-.682835183168444, -.271444547772685}, {-1.1794306316203, -.554074826447119}},
{{-1.74147316869059, .00466431737766077}, {-.428165191698978, 1.037934493808}},
{{-1.24851694511572, 2.14605819138361}, {.927292252697437, 1.25186068115305}},
{{.524945365792752, -.80174742913937}, {-.711141906838826, .492976124674822}},
{{-.577168922382629, -.41465722505101}, {.25115599305904, -.0334168206069655}},
{{-1.23569399061539, -.162254531065499}, {-.65961314792929, 1.44361746685625}},
{{-1.20491175737374, .30228481593515}, {1.29732120227476, .341121984561582}}
};
std::complex<double> nanson2_problem[48] = {{.860175122708103, -.509998782620213}, {.431767922731248, -.901984734294513}, {.908324276902771, .418266670903931}, {.647670829815403, -.76192026892991}, {-.224695532865945, .974429021278661}, {.0267060526341159, .999643329769525}, {-.968824828827829, .247746747802526}, {.367986731968437, -.929831041154892}, {.995106954764437, -.09880358586331}, {.659147709083959, -.752013495629812}, {.961373622869236, .275246720691238}, {-.841447402269425, -.54033903173289}, {.764522726180955, -.644596774078835}, {-.778529523403302, .627607983688407}, {-.0601732267667924, -.998187949626959}, {-.465050047288475, .885284391321222}, {.963657329529774, .267141444264166}, {-.932610952486528, .360883376317297}, {-.248277434004748, .968688967504027}, {-.191896152843875, .981415236545531}, {-.829730551677535, -.558164143969222}, {-.981364102310683, .192157484100797}, {-.940131469954786, -.340811999789697}, {.167703296757863, -.985837514125195}, {.613317652732317, .789836348142399}, {.599492916917923, .800380061324144}, {.998384879838455, -.056812249646998}, {.561329355140768, .827592505438062}, {.994206461820651, -.107487260985026}, {-.984539091624746, .175164999536778}, {-.36652680860573, .93040749060468}, {-.128080949782782, .991763716972314}, {.932674583611629, -.360718894826531}, {.873248327789044, .4872754436801}, {.128882457272022, -.991659877280273}, {-.464414827139504, .885617789078892}, {-.998296719377572, -.0583408954334498}, {.442034827710817, .89699788800792}, {.998788010130966, -.0492190087123401}, {-.619514061871884, .784985558556971}, {-.98960022257586, -.143845053713393}, {-.0863983863257232, -.996260668118696}, {.941354481174394, .337419235926002}, {-.443065741840718, -.896489123418201}, {-.941359476684483, .337405298797033}, {-.210362811414249, -.97762338739102}, {-.0506896145540402, .998714455175433}, {.182055588686202, -.983288239850411}};
std::complex<double> nanson2_sols[28][2] = {
{{.393951422998765, .401649934771358}, {-.349844149938431, -.512840788414711}},
{{.184577120929721, 1.28600142914917}, {1.1765729390423, -.336431934914944}},
{{.82568013429364, -.779008835206717}, {.567989067152187, 1.48517135229359}},
{{-.239298730276333, .183846584277691}, {.205361996795484, .0067742624725055}},
{{1.93614286423362, 3.6493744805523}, {-2.15832707986582, -2.04830642024391}},
{{.10163669408908, -.245577408335475}, {-.0223551143695219, .448654310538313}},
{{-.722188368391244, .0802252964846047}, {-.404148085536283, .2385653898977}},
{{5.97349944652796, 2.50666640660139}, {1.15697037453434, -5.65739100622604}},
{{-.904508914221182, -1.45866213501918}, {2.18986080092404, -.59694562368304}},
{{.91294987742576, -.598297443453856}, {.457214583710545, .846185266491708}},
{{1.67798834845732, -2.53850947811249}, {-.40726018703587, 1.08977975797254}},
{{.464466359728684, -.250121937368177}, {.180923580317875, -1.58640242128749}},
{{.262095846149282, -.537517380949733}, {.970194294752915, .0732577176034699}},
{{.518533726585329, .257910064142972}, {-1.21932836928689, .932319406686164}},
{{.314356873372108, .853687848278618}, {.683546902223998, .812849676974538}},
{{1.65661087897774, -.0425866837181099}, {1.93325410130042, .562929950978434}},
{{-.851623734969789, -.464604036354032}, {-.182429858900076, -.757679474543104}},
{{-.36653833444215, -.191906400639503}, {.214037410741437, .0907028074374863}},
{{-.415891880738006, .500218870130392}, {-.29361301335944, -.566619788515322}},
{{-.156056372223452, -1.04604053347751}, {-.489079999105048, .68298540948295}},
{{.452421392071725, -.474455013219828}, {.69622148293245, -.489927355449583}},
{{1.90187163332047, -1.05798982098671}, {.322626114365971, 1.30030589899704}},
{{-1.9360094821411, -1.4002364684891}, {3.02453658267042, .961506796256949}},
{{.330416194707058, -.294864548464559}, {1.05841751406097, .766382586207636}},
{{.0709019649593707, 3.48147366277052}, {-1.24260861571878, -3.88029706737765}},
{{-1.27307330171001, .0897692386837717}, {-.0117571193201049, -1.61291512926892}},
{{1.63626788511608, 1.57774025669131}, {-.00840675867194669, -.0323206265894733}},
{{2.51770874797117, .346617788985209}, {-1.98548620710879, -.529838480094318}}
};
std::complex<double> upright_nanson_problem[48] = {{.146978535015824, .98913968186733}, {.990446485012745, -.137897644381253}, {-.43447947510644, .900681733861208}, {-.995634989769968, -.0933325620871728}, {.441519245718405, .897251779413254}, {.871204121081839, -.490920950265947}, {-.923727212079457, .383050959617535}, {-.0538760904917315, .998547628745533}, {-.783051527697974, .621956835294757}, {-.258087375246132, -.966121579687858}, {.763577849003765, -.645715779976596}, {.269786774432079, -.962920088242807}, {.995568014077186, -.0940442945978518}, {.660099257884604, .751178387428841}, {-.283606422872071, .95894076819463}, {.615386162505445, .788225774126184}, {-.722867975161141, -.690986172427808}, {-.793234022808109, .608916895035492}, {-.44851009384015, .893777766407008}, {.615563857330219, .788087011407206}, {.314112056713805, -.949385915119359}, {-.618945561228332, .785433887883471}, {-.999999371728094, -.00112095647449761}, {-.965191892095265, .261542752592309}, {-.98859711902974, .150584648108958}, {-.990460340658257, -.137798089911033}, {.815921459372729, -.578162755748826}, {-.814460361374483, .580219199742431}, {-.938982520104333, .343964862941719}, {.942379737573521, .334545109381173}, {-.838754880152027, -.544509183596713}, {-.315508587096177, -.948922721547215}, {-.0278659520410265, -.999611668957925}, {.0181519356948213, -.999835240042344}, {.105957095293059, -.994370702483263}, {.678924119645991, .734208444355495}, {.526458265884146, .850200972877741}, {-.953962743109035, -.299925131924427}, {-.546634338232499, -.837371423124242}, {-.479823464970302, -.877365056555077}, {-.217051863077956, -.976160073315022}, {.674601621564528, -.738181991234214}, {-.826853133856425, -.562417900703569}, {-.570702894732306, -.821156626925805}, {.334419804201913, .942424211572238}, {-.385259826954248, -.922808141346392}, {.702607342514904, .71157776963881}, {-.640681874087095, -.767806444500336}};
std::complex<double> upright_nanson_sols[25][2] = {
{{.231512503379671, -.362386111023622}, {.70358524085521, -.702023001431775}},
{{.345334652275651, .194314903231523}, {.10335948554274, -.658139499472939}},
{{.509076979178073, 1.8326986510328}, {.772414201849811, 1.58071398852676}},
{{-.103858214113115, -.160364514914615}, {.00145391796870197, .0494293539922155}},
{{.723912703214383, .887353658725312}, {.0379278479167564, .101043898003645}},
{{.501846756141554, .28078706156967}, {-.262026110818509, .14997445136812}},
{{-2.25585339034768, -.949619104899101}, {-2.14013694576822, -.229771860234632}},
{{-.444824676138378, -2.9345467170823}, {-.740395530100872, .839565096068538}},
{{1.28602176853684, -.77569850238572}, {-1.62266078898557, .491290722758813}},
{{.621581429133779, -.555058139687048}, {.233602043960739, -.78112657134068}},
{{.154287034083114, -.413265934122747}, {.695136118680554, -.771531298386808}},
{{.480506961398213, .120034114047719}, {.04833615625046, -.547771751139682}},
{{-.814939463478348, .651474559234756}, {2.53141742223827, -.135914830394204}},
{{-9.2108476009926, 6.5167964371447}, {-1.12198487880966, 3.4524688297645}},
{{-.570901839591937, -.107886289083696}, {.0124091141518816, -1.0038842968323}},
{{-.431254254257848, -1.06335672759282}, {.234102029635272, -1.74767246046564}},
{{-.598655969515417, .0829266704711207}, {-.0683987551160875, -.778232677603688}},
{{-.247298781816928, .545100215537027}, {1.15195469572045, -1.46189048293805}},
{{1.00261761106415, .525380009160528}, {-.928005976826692, -.646292684862029}},
{{.694384532210316, -.778588804498435}, {-1.71780941312135, -.926143145924716}},
{{.675517395750695, -.349938144153133}, {.828392264821781, -.252265738886175}},
{{-.091809843656929, -.149168234358693}, {-.0380182354165577, .0300593506151767}},
{{.434277057492454, 2.91734433464718}, {1.06047639876645, 3.09356284229087}},
{{-1.22406267345069, -.463491782716766}, {1.10942196826531, -1.25805870171119}},
{{.00506319545734992, -1.0790374293414}, {.258041983883572, -.717889733850147}}
};

// clang-format on

void get_system_parameters(MinimalSolver solver, size_t &problem_sz, size_t &sols_sz, size_t &sols_dim) {
    if(solver == MinimalSolver::MINIMAL) {
        problem_sz = 224;
        sols_sz = 28;
        sols_dim = 13;
    } else if(solver == MinimalSolver::UPRIGHT) {
        problem_sz = 114;
        sols_sz = 25;
        sols_dim = 8;
    } else if(solver == MinimalSolver::NANSON) {
        problem_sz = 48;
        sols_sz = 28;
        sols_dim = 2;
    } else if(solver == MinimalSolver::NANSON2) {
        problem_sz = 48;
        sols_sz = 28;
        sols_dim = 2;
    } else if(solver == MinimalSolver::UPRIGHT_NANSON) {
        problem_sz = 48;
        sols_sz = 25;
        sols_dim = 2;
    /*} else if(solver == MinimalSolver::LINEAR) {
	    problem_sz = 240;
	    sols_sz = 1;
	    sols_dim = 16;*/
    } else {
        problem_sz = 0;
        sols_sz = 0;
        sols_dim = 0;
    }
}

bool TrackSettings::load_settings(const std::string &filename) {

    // loads the track settings
    std::ifstream f;
    f.open(filename);

    if (!f.good()) {
        f.close();
        std::cout << "Settings file not available\n";

        return 0;
    }

    std::string t;

    // init dt
    f >> init_dt_;
    getline(f, t);

    // min dt
    f >> min_dt_;
    getline(f, t);

    // end zone factor
    f >> end_zone_factor_;
    getline(f, t);

    // corrector tolerance epsilon
    f >> epsilon_;
    getline(f, t);
    epsilon2_ = epsilon_ * epsilon_;

    // step increase factor
    f >> dt_increase_factor_;
    getline(f, t);
    dt_decrease_factor_ = 1. / dt_increase_factor_;

    // infinity threshold
    f >> infinity_threshold_;
    getline(f, t);
    infinity_threshold2_ = infinity_threshold_ * infinity_threshold_;

    // max corr steps
    f >> max_corr_steps_;
    getline(f, t);

    // num successes before increase
    f >> num_successes_before_increase_;
    getline(f, t);

    f.close();
    return true;
}

// loads the starting system
bool StartSystem::load_start_system(const std::string &filename, MinimalSolver solver) {
    std::ifstream f;
    f.open(filename);

    if (!f.good()) {
        f.close();
        std::cout << "Data file not available\n";
        return 0;
    }

    size_t problem_sz;
    size_t sols_sz;
    size_t sols_dim;
    get_system_parameters(solver, problem_sz, sols_sz, sols_dim);

    if(problem_sz == 0) {
        return true; // Nothing to do
    }

    problem.resize(problem_sz);
    sols.resize(sols_sz);

    // load the points
    for (int j = 0; j < problem_sz; j++) {
        // skip the special characters
        char tr;
        f.get(tr);
        while (tr != '{' && tr != ',')
            f.get(tr);

        // load the real part
        double re;
        f >> re;

        // skip the special characters
        f.get(tr);
        while (tr != '{' && tr != ',')
            f.get(tr);

        // load the complex part
        double im;
        f >> im;

        std::complex<double> u = std::complex<double>(re, im);
        problem[j] = u;
    }

    // load the solutions
    for (int j = 0; j < sols_sz; ++j) {
        std::vector<std::complex<double>> sol(sols_dim);
        for (int k = 0; k < sols_dim; ++k) {
            // skip the special characters
            char tr;
            f.get(tr);
            while (tr != '{' && tr != ',')
                f.get(tr);

            // load the real part
            double re;
            f >> re;

            // skip the special characters
            f.get(tr);
            while (tr != '{' && tr != ',')
                f.get(tr);

            // load the complex part
            double im;
            f >> im;

            std::complex<double> u = std::complex<double>(re, im);

            sol[k] = u;
        }
        sols[j] = sol;
    }

    f.close();
    return true;
}

// loads the default starting system
bool StartSystem::load_default(MinimalSolver solver) {
    size_t problem_sz;
    size_t sols_sz;
    size_t sols_dim;
    get_system_parameters(solver, problem_sz, sols_sz, sols_dim);

    if(problem_sz == 0) {
        return true; // Nothing to do
    }


    if(solver == MinimalSolver::MINIMAL) {
        problem.assign(default_problem, default_problem + problem_sz);
        sols.resize(sols_sz);
        for (int i = 0; i < sols_sz; ++i) {
            sols[i].assign(default_sols[i], default_sols[i] + sols_dim);
        }
    } else if(solver == MinimalSolver::UPRIGHT) {
        problem.assign(upright_problem, upright_problem + problem_sz);
        sols.resize(sols_sz);
        for (int i = 0; i < sols_sz; ++i) {
            sols[i].assign(upright_sols[i], upright_sols[i] + sols_dim);
        }
    } else if(solver == MinimalSolver::NANSON) {
        problem.assign(nanson_problem, nanson_problem + problem_sz);
        sols.resize(sols_sz);
        for (int i = 0; i < sols_sz; ++i) {
            sols[i].assign(nanson_sols[i], nanson_sols[i] + sols_dim);
        }
    } else if(solver == MinimalSolver::NANSON2) {
        problem.assign(nanson2_problem, nanson2_problem + problem_sz);
        sols.resize(sols_sz);
        for (int i = 0; i < sols_sz; ++i) {
            sols[i].assign(nanson2_sols[i], nanson2_sols[i] + sols_dim);
        }
    } else if(solver == MinimalSolver::UPRIGHT_NANSON) {
        problem.assign(upright_nanson_problem, upright_nanson_problem + problem_sz);
        sols.resize(sols_sz);
        for (int i = 0; i < sols_sz; ++i) {
            sols[i].assign(upright_nanson_sols[i], upright_nanson_sols[i] + sols_dim);
        }
    } else if(solver == MinimalSolver::LINEAR) {
        return true;
    } else {
        return false;
    }

    
    return true;
}

} // namespace rqt
